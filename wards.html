<!DOCTYPE html>
<html lang="en">
<head>
	<title>UK wards (super-generalised clipped)</title>
	<link rel="icon" href="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='640' height='640' overflow='auto' viewBox='-32 -32 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cmask id='oi-person'%3E%3Cpath d='m-32-32h64v64h-12v-24a4 4 0 0 0 -4 -4h-8a4 4 0 0 0 -4 4v24h-36zm44 27m-8 0a8 8 0 1 0 16 0 8 8 0 1 0-16 0' fill='%23fff'%3E%3C/path%3E%3C/mask%3E%3Cg id='oi-logo' fill='%23F9BC26'%3E%3Ccircle r='32' mask='url(%23oi-person)'%3E%3C/circle%3E%3C/g%3E%3C/svg%3E" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8" />
	<link rel="StyleSheet" href="resources/leaflet.css" type="text/css" />
	<script type="text/javascript" src="resources/leaflet.js"></script>
	<style>
	body { width: 100vw; height: 100vh; overflow: hidden; padding: 0; margin: 0; }
	.b1-bg { background: black; color: white; }
	#map {
		width: 100%;
		height: 100%;
	}
	.leaflet-popup-content-wrapper { border-radius: 0; }
	.leaflet-popup-content { margin: 1rem; font-size: 1rem; }
	</style>
</head>
<body class="b1-bg">

	<div id="map"></div>

	<script>
	var wards,map,locked;
	var map = L.map(document.getElementById('map'),{'scrollWheelZoom':true}).setView([53.7965, -1.5478], 6);
	// CartoDB map
	L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
		attribution: 'Tiles: &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
		subdomains: 'abcd',
		maxZoom: 19
	}).addTo(map);
	
	function onEachFeature(feature, layer) {
		layer.on({
			mouseover: highlightFeature,
			mouseout: resetHighlight,
			click: clickFeature
		});
		if(feature.properties && feature.properties.WD24NM){
			layer.bindPopup(feature.properties.WD24NM);
		}
	}
	function clickFeature(e){
		var layer = e.target;
		if(locked){
			wards.resetStyle(locked);
			locked = null;

		}else{
			locked = layer;
			highlightFeature(e);
		}
	}
	function highlightFeature(e) {
		var layer = e.target;
		layer.setStyle({
			weight: 4,
			fillOpacity: 0.1
		});
		layer.bringToFront();
	}
	function resetHighlight(e) {
		if(!locked || e.target!=locked) wards.resetStyle(e.target);
	}

	fetch("UK_WARDS_2024_BSC.geojson",{}).then(response=>{
		if(!response.ok) throw new Error('Network response was not OK');
		return response.json();
	}).then(d=>{
		wards = L.geoJSON(d,{
			'style': { "color": "#2254F4", "weight": 1, "opacity": 0.8, "fillOpacity": 0.08 },
			onEachFeature: onEachFeature
		}).addTo(map);
	}).catch(e => {
		console.log('Unable to load GeoJSON');
	});

	/*
	Open Innovations Log
	Web usage monitoring with less privacy invasion
	Version: 2022-01-25 https://open-innovations.org/resources/oi.log.js
	*/
	!function(t){t.OI||(t.OI={});var e=location;function n(t){return 50*Math.round(t/50)}t.OI.log=new function(){var t,r,o,u,f,s;return r="https://open-innovations.org/log",o=document.referrer,u=new RegExp(e.origin,"g"),0==o.indexOf(e.origin)&&(o=o.replace(u,"")),f=n(window.innerWidth)+"x"+n(window.innerHeight),this.setup=function(e){return e||(e={}),e.dest&&(r=e.dest),e.id&&(t=e.id),e.target&&(s=e.target),s="string"==typeof s?[s]:s,this},this.add=function(n,u){if("file:"==e.protocol)return this;if(!function(t){if("object"!=typeof t||t.length<=0)return!0;for(i=0;i<t.length;i++)if(t[i]==e.host)return!0;return!1}(s))return this;var d=new XMLHttpRequest;return d.open("POST",r,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),"function"==typeof u&&(d.onload=u),d.send((t?"oid="+t+"&":"")+"url="+e.href+"&"+(o?"ref="+o+"&":"")+(f?"size="+f+"&":"")+n),this},this}}(window||this);	
	OI.log.setup({'id':'odileeds','target':['open-innovations.org','open-innovations.github.io']}).add('action=view');
	</script>
</body>
</html>
